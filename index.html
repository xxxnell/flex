<html><head><title>Flex: Home</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="flex contributors" /><meta name="description" content="Probabilistic deep learning library" /><meta name="og:image" content="/flex/img/poster.png" /><meta name="og:title" content="Flex: Home" /><meta name="og:site_name" content="Flex" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Probabilistic deep learning library" /><link rel="icon" type="image/png" href="/flex/img/favicon.png" /><meta name="twitter:title" content="Flex: Home" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="Probabilistic deep learning library" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:creator" content="@xxxnell" /><link rel="icon" type="image/png" sizes="16x16" href="/flex/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/flex/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/flex/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/flex/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/flex/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/flex/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/flex/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/flex/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/flex/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/flex/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/flex/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/flex/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/flex/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/flex/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/flex/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/flex/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/flex/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/flex/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/flex/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/flex/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/flex/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/flex/css/style.css" /><link rel="stylesheet" href="/flex/css/palette.css" /><link rel="stylesheet" href="/flex/css/codemirror.css" /></head><body><header id="site-header"><div class="navbar-wrapper"><div class="container"><div class="row"><div class="col-xs-6"><a href="/flex/" class="brand"><div class="icon-wrapper"><span>Flex</span></div></a></div><div class="col-xs-6"><nav class="text-right"><ul class=""><li><a href="https://github.com/xxxnell/flex"><i class="fa fa-github"></i><span class="hidden-xs">GitHub</span></a></li></ul></nav></div></div></div></div><div class="jumbotron"><div class="container"><h1 class="text-center">Probabilistic deep learning library</h1><h2></h2><p class="text-center"><a href="https://github.com/xxxnell/flex" class="btn btn-outline-inverse">View on GitHub</a></p></div></div><div><ul class="horizontalNav">                         <li><a class=" active " href="/flex/">Home</a></li>  <li><a class="" href="/flex/docs/">Documentation</a></li>  <li><a class="" href="/flex/experiments/">Experiments</a></li>  <li><a class="" href="/flex/contributing.html">Contributing</a></li> </ul></div></header><main id="site-main"><section class="use"><div class="container"><div id="content"><h1 id="chain">Chain</h1>

<p><a href="https://travis-ci.org/xxxnell/flex"><img src="https://travis-ci.org/xxxnell/flex.svg?branch=master" alt="Build Status" /></a>
<a href="https://codecov.io/gh/xxxnell/flex"><img src="https://codecov.io/gh/xxxnell/flex/branch/master/graph/badge.svg" alt="codecov" /></a>
<a href="https://waffle.io/xxxnell/flex"><img src="https://badge.waffle.io/xxxnell/flex.svg?columns=to%20do" alt="Waffle.io - Columns and their card count" /></a>
<a href="https://index.scala-lang.org/xxxnell/flex/flex"><img src="https://index.scala-lang.org/xxxnell/flex/flex/latest.svg" alt="Latest version" /></a></p>

<p>Chain is a probabilistic deep learning library for data streams. It has the following features:</p>

<ul>
  <li><strong>Fast</strong>. Chain provides probabilistic deep learning that is fast enough to solve the real-world problems.</li>
  <li><strong>Typesafe and Functional</strong>. Types and pure functions make the code easy to understand and maintain.</li>
  <li><strong>Easy</strong>. You can program with a minimal knowledge of probability theory.</li>
</ul>

<p>Today, neural networks have been widely used for solving problems in many areas. However, classical neural networks have some limitations when you want to include uncertainties in the model. For example, suppose that input data and training data contain a lot of noise. If you need to detect whether the data contains false-positive or false-negative, the model should represent how reliable the input and the output are. To deal with this issue, probabilistic deep learning, also known as the Bayesian neural network, can be used. It is a way to treat both input and output as a probability distribution and it is one of the best approaches to represent uncertainties. However, the Bayesian neural network is so computationally slow that it cannot be readily applied to the real-world problems. Chain is fast enough to make it possible to apply the Bayesian neural network to the real-world problems.</p>

<h2 id="getting-started">Getting Started</h2>

<p><strong>WIP</strong>. Chain is published to Maven Central and built for Scala 2.12, so you can add the following to your <code class="highlighter-rouge">build.sbt</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">libraryDependencies</span> <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="s">"com.xxxnell"</span> <span class="o">%%</span> <span class="s">"flex-core"</span><span class="o">,</span>
  <span class="s">"com.xxxnell"</span> <span class="o">%%</span> <span class="s">"flex-chain"</span>
<span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span> <span class="o">%</span> <span class="s">"0.0.5"</span><span class="o">)</span>
</code></pre></div></div>

<p>Then, you need to <code class="highlighter-rouge">import</code> the context of Chain.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">flex.implicits._</span>
<span class="k">import</span> <span class="nn">flex.chain.implicits._</span>
</code></pre></div></div>

<h2 id="building-a-model">Building a Model</h2>

<p>We will use 3 hiddel layers with 10 neurons each.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="o">(</span><span class="n">kin</span><span class="o">,</span> <span class="n">kout</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="mi">20</span><span class="o">,</span> <span class="mi">10</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">l0</span><span class="o">,</span> <span class="n">l1</span><span class="o">,</span> <span class="n">l2</span><span class="o">,</span> <span class="n">l3</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="mi">784</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span>
<span class="k">val</span> <span class="o">(</span><span class="n">k0</span><span class="o">,</span> <span class="n">k1</span><span class="o">,</span> <span class="n">k2</span><span class="o">,</span> <span class="n">k3</span><span class="o">)</span> <span class="k">=</span> <span class="o">(</span><span class="mi">20</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">20</span><span class="o">)</span>
<span class="k">val</span> <span class="n">model0</span> <span class="k">=</span> <span class="nc">Complex</span>
  <span class="o">.</span><span class="n">empty</span><span class="o">(</span><span class="n">kin</span><span class="o">,</span> <span class="n">kout</span><span class="o">)</span>
  <span class="o">.</span><span class="n">addStd</span><span class="o">(</span><span class="n">l0</span> <span class="o">-&gt;</span> <span class="n">k0</span><span class="o">,</span> <span class="n">l0</span> <span class="o">*</span> <span class="n">l1</span> <span class="o">-&gt;</span> <span class="n">k1</span><span class="o">,</span> <span class="n">l1</span> <span class="o">*</span> <span class="n">l2</span> <span class="o">-&gt;</span> <span class="n">k2</span><span class="o">,</span> <span class="n">l2</span> <span class="o">*</span> <span class="n">l3</span> <span class="o">-&gt;</span> <span class="n">k3</span><span class="o">)</span>
  <span class="o">.</span><span class="n">map</span> <span class="o">{</span> <span class="k">case</span> <span class="n">x1</span> <span class="o">::</span> <span class="n">z1</span> <span class="o">::</span> <span class="n">rem</span> <span class="k">=&gt;</span> <span class="n">z1</span><span class="o">.</span><span class="n">reshape</span><span class="o">(</span><span class="n">l1</span><span class="o">,</span> <span class="n">l0</span><span class="o">).</span><span class="n">mmul</span><span class="o">(</span><span class="n">x1</span><span class="o">).</span><span class="n">tanh</span> <span class="o">::</span> <span class="n">rem</span> <span class="o">}</span>
  <span class="o">.</span><span class="n">map</span> <span class="o">{</span> <span class="k">case</span> <span class="n">h1</span> <span class="o">::</span> <span class="n">z2</span> <span class="o">::</span> <span class="n">rem</span> <span class="k">=&gt;</span> <span class="n">z2</span><span class="o">.</span><span class="n">reshape</span><span class="o">(</span><span class="n">l2</span><span class="o">,</span> <span class="n">l1</span><span class="o">).</span><span class="n">mmul</span><span class="o">(</span><span class="n">h1</span><span class="o">).</span><span class="n">tanh</span> <span class="o">::</span> <span class="n">rem</span> <span class="o">}</span>
  <span class="o">.</span><span class="n">map</span> <span class="o">{</span> <span class="k">case</span> <span class="n">h2</span> <span class="o">::</span> <span class="n">z3</span> <span class="o">::</span> <span class="n">rem</span> <span class="k">=&gt;</span> <span class="n">z3</span><span class="o">.</span><span class="n">reshape</span><span class="o">(</span><span class="n">l3</span><span class="o">,</span> <span class="n">l2</span><span class="o">).</span><span class="n">mmul</span><span class="o">(</span><span class="n">h2</span><span class="o">)</span> <span class="o">::</span> <span class="n">rem</span> <span class="o">}</span>
</code></pre></div></div>

<p>First, construct an empty model using <code class="highlighter-rouge">Complex.empty</code>. Second, <code class="highlighter-rouge">add</code> the variables to be used for this neural network. Here, a prior probabilities of these variables are standard normal distributions with a mean of zero and a variance of one. Third, define a transformation of each layers using <code class="highlighter-rouge">map</code> operation. In this example, <code class="highlighter-rouge">tanh</code> was used as the activator.</p>

<h2 id="contributing">Contributing</h2>

<p>Contributions are always welcome. Any kind of contribution, such as writing a unit test, documentation, bug fix, or implementing the algorithm of Chain in another language, is helpful. It is also possible to make academic collaboration works. If you need some help, please contact me via <a href="mailto:xxxxxnell@gmail.com">email</a> or <a href="https://twitter.com/xxxnell">twitter</a>.</p>

<p>The <code class="highlighter-rouge">master</code> branch of this repository contains the latest stable release of Chain. In general, pull requests should be submitted from a separate <code class="highlighter-rouge">feature</code> branch starting from the <code class="highlighter-rouge">develop</code> branch.</p>

<p>Fo more detail, see the contributing documentation.</p>

<h2 id="license">License</h2>

<p>All code of Chain is available to you under the MIT license.</p>

<p>Copyright the maintainers.</p>

</div></div></section><section class="technologies"><div class="container"><div class="row"></div></div></section></main><footer id="site-footer"><div class="container"><div class="row"><div class="col-xs-6"><p>Flex is designed and developed by <a href="" target="_blank">flex contributors</a></p></div><div class="col-xs-6"><p class="text-right"><a href="https://github.com/xxxnell/flex"><span class="fa fa-github"></span>View on GitHub</a></p></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/flex/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script></body></html>